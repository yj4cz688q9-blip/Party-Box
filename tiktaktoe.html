<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic Tac Toe</title>
    <link rel="icon" type="image/png" href="F1CE1FF7-8FC2-440D-8100-49C689144B20.png">
    <link rel="apple-touch-icon" href="F1CE1FF7-8FC2-440D-8100-49C689144B20.png">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: #0d0d0d; color: white; font-family: Arial, sans-serif; text-align: center; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .screen { display: none; flex-direction: column; align-items: center; justify-content: center; width: 100%; min-height: 100vh; padding: 20px; }
        .screen.active { display: flex; }
        h1 { font-size: 42px; color: #00e5cc; margin-bottom: 10px; }
        h2 { font-size: 26px; color: #00e5cc; margin-bottom: 20px; }
        .subtitle { font-size: 16px; color: #888; margin-bottom: 40px; }
        .start-btn { background-color: #00e5cc; color: #0d0d0d; border: none; border-radius: 20px; padding: 18px 40px; font-size: 20px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; max-width: 320px; }
        .back-btn { background: none; border: none; color: #888; font-size: 16px; margin-top: 20px; cursor: pointer; }
        .mode-options { display: flex; gap: 10px; justify-content: center; margin-bottom: 30px; }
        .mode-btn { background-color: #1a1a1a; border: 2px solid #333; border-radius: 16px; color: white; padding: 20px; font-size: 16px; cursor: pointer; flex: 1; max-width: 150px; }
        .mode-btn.selected { border-color: #00e5cc; color: #00e5cc; font-weight: bold; }
        .player-input { background-color: #1a1a1a; border: 2px solid #333; border-radius: 12px; padding: 12px 16px; color: white; font-size: 16px; width: 100%; max-width: 320px; margin: 6px 0; }
        .player-input:focus { border-color: #00e5cc; outline: none; }
        .diff-options { display: flex; gap: 8px; justify-content: center; margin-top: 10px; flex-wrap: wrap; }
        .diff-btn { background-color: #1a1a1a; border: 2px solid #333; border-radius: 12px; color: white; padding: 10px 16px; font-size: 14px; cursor: pointer; }
        .diff-btn.selected { border-color: #00e5cc; color: #00e5cc; font-weight: bold; }

        /* GRILLE */
        .tour-info { font-size: 20px; font-weight: bold; color: #00e5cc; margin-bottom: 30px; }
        .grille { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; width: 100%; max-width: 300px; margin-bottom: 40px; }
        .cell {
            background-color: #1a1a1a;
            border: 2px solid #333;
            border-radius: 16px;
            aspect-ratio: 1;
            font-size: 52px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .cell:active { background-color: #2a2a2a; }
        .cell.x { color: #00e5cc; border-color: #00e5cc; }
        .cell.o { color: #ff6b6b; border-color: #ff6b6b; }
        .cell.gagnante { background-color: #003d2e; }

        /* SCORE */
        .score-box { display: flex; gap: 20px; margin-bottom: 30px; }
        .score-item { background-color: #1a1a1a; border-radius: 16px; padding: 15px 25px; }
        .score-nom { font-size: 13px; color: #888; margin-bottom: 5px; }
        .score-pts { font-size: 28px; font-weight: bold; }
        .score-item.x .score-pts { color: #00e5cc; }
        .score-item.o .score-pts { color: #ff6b6b; }
        .score-item.nul .score-pts { color: #888; }

        /* FIN */
        .resultat { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
        .rejouer-btn { background-color: #1a1a1a; border: 2px solid #00e5cc; color: #00e5cc; border-radius: 20px; padding: 16px 40px; font-size: 18px; cursor: pointer; margin-top: 15px; width: 100%; max-width: 320px; }
    </style>
</head>
<body>

    <!-- ACCUEIL -->
    <div class="screen active" id="screen-home">
        <h1>‚ùå‚≠ï Tic Tac Toe</h1>
        <p class="subtitle">Le classique des classiques !</p>
        <div class="mode-options">
            <button class="mode-btn selected" id="mode-local" onclick="selectMode('local')">üë• 2 Joueurs</button>
            <button class="mode-btn" id="mode-solo" onclick="selectMode('solo')">ü§ñ vs Bot</button>
        </div>

        <div id="config-local">
            <input class="player-input" id="nom-j1" placeholder="‚ùå Joueur 1">
            <input class="player-input" id="nom-j2" placeholder="‚≠ï Joueur 2">
        </div>

        <div id="config-solo" style="display:none">
            <input class="player-input" id="nom-solo" placeholder="‚ùå Ton nom">
            <p style="color:#888; font-size:14px; margin-top:15px">Difficult√© du bot</p>
            <div class="diff-options">
                <button class="diff-btn" onclick="selectDiff('facile', this)">üò¥ Facile</button>
                <button class="diff-btn selected" onclick="selectDiff('normal', this)">üòê Normal</button>
                <button class="diff-btn" onclick="selectDiff('expert', this)">üî• Expert</button>
            </div>
        </div>

        <button class="start-btn" onclick="startGame()" style="margin-top:30px">C'est parti ! üöÄ</button>
        <button class="back-btn" onclick="window.location.href='index.html'">‚Üê Retour √† Party Box</button>
    </div>

    <!-- JEU -->
    <div class="screen" id="screen-jeu">
        <div class="score-box">
            <div class="score-item x">
                <div class="score-nom" id="score-nom-x">Joueur 1</div>
                <div class="score-pts" id="score-x">0</div>
            </div>
            <div class="score-item nul">
                <div class="score-nom">ü§ù Nul</div>
                <div class="score-pts" id="score-nul">0</div>
            </div>
            <div class="score-item o">
                <div class="score-nom" id="score-nom-o">Joueur 2</div>
                <div class="score-pts" id="score-o">0</div>
            </div>
        </div>

        <div class="tour-info" id="tour-info">Tour de ‚ùå</div>

        <div class="grille" id="grille"></div>

        <button class="rejouer-btn" onclick="resetGrille()">üîÑ Rejouer</button>
        <button class="back-btn" onclick="showScreen('screen-home')">‚Üê Quitter</button>
    </div>

    <script>
        let modeJeu = 'local';
        let diffBot = 'normal';
        let plateau = Array(9).fill(null);
        let joueurCourant = 'X';
        let scores = { X: 0, O: 0, nul: 0 };
        let nomX = 'Joueur 1', nomO = 'Joueur 2';
        let partieTerminee = false;

        const COMBOS = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function selectMode(mode) {
            modeJeu = mode;
            document.getElementById('mode-local').classList.toggle('selected', mode === 'local');
            document.getElementById('mode-solo').classList.toggle('selected', mode === 'solo');
            document.getElementById('config-local').style.display = mode === 'local' ? 'block' : 'none';
            document.getElementById('config-solo').style.display = mode === 'solo' ? 'block' : 'none';
        }

        function selectDiff(diff, btn) {
            diffBot = diff;
            document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }

        function startGame() {
            if (modeJeu === 'local') {
                nomX = document.getElementById('nom-j1').value.trim() || 'Joueur 1';
                nomO = document.getElementById('nom-j2').value.trim() || 'Joueur 2';
            } else {
                nomX = document.getElementById('nom-solo').value.trim() || 'Joueur';
                nomO = 'ü§ñ Bot';
            }
            scores = { X: 0, O: 0, nul: 0 };
            document.getElementById('score-nom-x').textContent = nomX;
            document.getElementById('score-nom-o').textContent = nomO;
            resetGrille();
            showScreen('screen-jeu');
        }

        function resetGrille() {
            plateau = Array(9).fill(null);
            joueurCourant = 'X';
            partieTerminee = false;
            renderGrille();
            document.getElementById('tour-info').textContent = 'Tour de ' + (joueurCourant === 'X' ? '‚ùå ' + nomX : '‚≠ï ' + nomO);
            document.getElementById('tour-info').style.color = '#00e5cc';
        }

        function renderGrille() {
            const grille = document.getElementById('grille');
            grille.innerHTML = '';
            plateau.forEach((val, idx) => {
                const cell = document.createElement('div');
                cell.className = 'cell' + (val ? ' ' + val.toLowerCase() : '');
                cell.textContent = val === 'X' ? '‚ùå' : val === 'O' ? '‚≠ï' : '';
                cell.onclick = () => jouerCoup(idx);
                grille.appendChild(cell);
            });
        }

        function jouerCoup(idx) {
            if (partieTerminee || plateau[idx]) return;
            if (modeJeu === 'solo' && joueurCourant === 'O') return;
            plateau[idx] = joueurCourant;
            renderGrille();
            const gagnant = verifierGagnant();
            if (gagnant) { finPartie(gagnant); return; }
            if (plateau.every(c => c)) { finPartie('nul'); return; }
            joueurCourant = joueurCourant === 'X' ? 'O' : 'X';
            document.getElementById('tour-info').textContent = 'Tour de ' + (joueurCourant === 'X' ? '‚ùå ' + nomX : '‚≠ï ' + nomO);
            if (modeJeu === 'solo' && joueurCourant === 'O') setTimeout(jouerBot, 400);
        }

        function verifierGagnant() {
            for (const combo of COMBOS) {
                const [a, b, c] = combo;
                if (plateau[a] && plateau[a] === plateau[b] && plateau[a] === plateau[c]) {
                    // Surligner les cases gagnantes
                    const cells = document.querySelectorAll('.cell');
                    combo.forEach(i => cells[i].classList.add('gagnante'));
                    return plateau[a];
                }
            }
            return null;
        }

        function finPartie(resultat) {
            partieTerminee = true;
            const tourInfo = document.getElementById('tour-info');
            if (resultat === 'nul') {
                scores.nul++;
                tourInfo.textContent = 'ü§ù Match nul !';
                tourInfo.style.color = '#888';
            } else if (resultat === 'X') {
                scores.X++;
                tourInfo.textContent = 'üéâ ' + nomX + ' gagne !';
                tourInfo.style.color = '#00e5cc';
            } else {
                scores.O++;
                tourInfo.textContent = 'üéâ ' + nomO + ' gagne !';
                tourInfo.style.color = '#ff6b6b';
            }
            document.getElementById('score-x').textContent = scores.X;
            document.getElementById('score-o').textContent = scores.O;
            document.getElementById('score-nul').textContent = scores.nul;
        }

        // IA BOT
        function jouerBot() {
            if (partieTerminee) return;
            let idx = -1;

            if (diffBot === 'facile') {
                // Joue al√©atoirement
                const libres = plateau.map((v,i) => v ? -1 : i).filter(i => i !== -1);
                idx = libres[Math.floor(Math.random() * libres.length)];
            } else if (diffBot === 'normal') {
                // Gagne si possible, sinon bloque, sinon al√©atoire
                idx = trouverCoupGagnant('O') || trouverCoupGagnant('X') || coupAleatoire();
            } else {
                // Expert : minimax
                idx = minimax(plateau, 'O').idx;
            }

            if (idx !== -1 && idx !== undefined) {
                plateau[idx] = 'O';
                renderGrille();
                const gagnant = verifierGagnant();
                if (gagnant) { finPartie(gagnant); return; }
                if (plateau.every(c => c)) { finPartie('nul'); return; }
                joueurCourant = 'X';
                document.getElementById('tour-info').textContent = 'Tour de ‚ùå ' + nomX;
                document.getElementById('tour-info').style.color = '#00e5cc';
            }
        }

        function trouverCoupGagnant(joueur) {
            for (const combo of COMBOS) {
                const [a, b, c] = combo;
                const vals = [plateau[a], plateau[b], plateau[c]];
                if (vals.filter(v => v === joueur).length === 2 && vals.includes(null)) {
                    return combo[vals.indexOf(null)];
                }
            }
            return null;
        }

        function coupAleatoire() {
            const libres = plateau.map((v,i) => v ? -1 : i).filter(i => i !== -1);
            if (plateau[4] === null) return 4;
            return libres[Math.floor(Math.random() * libres.length)];
        }

        function minimax(board, joueur) {
            const gagnant = verifierGagnantBoard(board);
            if (gagnant === 'O') return { score: 10 };
            if (gagnant === 'X') return { score: -10 };
            if (board.every(c => c)) return { score: 0 };

            const moves = [];
            board.forEach((val, idx) => {
                if (val) return;
                const newBoard = [...board];
                newBoard[idx] = joueur;
                const result = minimax(newBoard, joueur === 'O' ? 'X' : 'O');
                moves.push({ idx, score: result.score });
            });

            return joueur === 'O'
                ? moves.reduce((a, b) => a.score > b.score ? a : b)
                : moves.reduce((a, b) => a.score < b.score ? a : b);
        }

        function verifierGagnantBoard(board) {
            for (const [a, b, c] of COMBOS) {
                if (board[a] && board[a] === board[b] && board[a] === board[c]) return board[a];
            }
            return null;
        }
    </script>
</body>
</html>
